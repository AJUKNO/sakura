{%- comment -%}
  Renders a product info section

  Accepts:
  - product: {Object} Product object
  - section: {Object} Section object
  - class: {String} (optional) Additional classes

  Usage:
  {%- render 'product-info',
    product: product,
    section: section,
    class: 'my-class'
  -%}
{%- endcomment -%}

<cmp-product-info
  data-id='product-info'
  data-section='{{ section.id }}'
  class='group/info grid grid-cols-4 gap-x-sm relative {{ class }} space-y-md'
>
  <!-- Product info blocks -->
  {%- for block in section.blocks -%}
    {%- case block.type -%}
      {%- when '@app' -%}
        {%- render block -%}
      {%- when 'text' -%}
        {%- assign text_id = 'product-info-text-' | append: section.id -%}
        {%- render 'product-text',
          block: block,
          data_id: text_id,
          class: 'col-span-full'
        -%}
      {%- when 'title' -%}
        {%- assign title_id = 'product-info-title-' | append: section.id -%}
        {%- render 'product-title',
          block: block,
          product: product,
          data_id: title_id,
          class: 'col-span-full'
        -%}
      {%- when 'description' -%}
        {%- assign description_id = 'product-info-description-'
          | append: section.id
        -%}
        {%- render 'product-description',
          block: block,
          product: product,
          data_id: description_id,
          class: 'col-span-full'
        -%}
      {%- when 'sku' -%}
        {%- assign sku_id = 'product-info-sku-' | append: section.id -%}
        {%- render 'product-sku',
          block: block,
          product: product,
          section: section,
          data_id: sku_id,
          class: 'col-span-full'
        -%}
      {%- when 'custom_liquid' -%}
        {{ block.settings.custom_liquid }}
      {%- when 'collapsible_tab' -%}
        {%- assign tab_id = 'product-info-collapsible-tab-' | append: section.id -%}
        {%- render 'product-collapsible-tab',
          block: block,
          product: product,
          section: section,
          data_id: tab_id,
          class: 'col-span-full'
        -%}
      {%- when 'quantity_selector' -%}
        {%- assign quantity_selector_id = 'product-info-quantity-selector-'
          | append: section.id
        -%}
        {%- render 'product-quantity-selector',
          block: block,
          section: section,
          product: product,
          data_id: quantity_selector_id,
          class: 'col-span-full'
        -%}

        {%- comment -%}
          Future features:
          TODO: Price per item
          TODO: Volume pricing
          TODO: Quantity rules
        {%- endcomment -%}
      {%- when 'variant_picker' -%}
        {%- assign variant_picker_id = 'product-info-variant-picker-'
          | append: section.id
        -%}
        {%- render 'product-variant-picker',
          block: block,
          product: product,
          section: section,
          update_url: true,
          data_id: variant_picker_id,
          class: 'col-span-full'
        -%}
      {%- when 'price' -%}
        {%- assign price_id = 'product-info-price-' | append: section.id -%}
        {%- render 'product-price',
          block: block,
          product: product,
          section: section,
          data_id: price_id,
          show_tax: true,
          class: 'col-span-full'
        -%}
      {%- when 'inventory' -%}
        {%- assign inventory_id = 'product-info-inventory-' | append: section.id -%}
        {%- render 'product-inventory',
          block: block,
          product: product,
          section: section,
          data_id: inventory_id,
          class: 'col-span-full'
        -%}
      {%- when 'buy_buttons' -%}
        {%- assign buy_buttons_id = 'product-info-buy-buttons-'
          | append: section.id
        -%}
        {%- render 'product-buy-buttons',
          block: block,
          product: product,
          section: section,
          data_id: buy_buttons_id,
          class: 'col-span-full'
        -%}
      {%- when 'pickup_availability' -%}
        {%- assign pickup_availability_id = 'product-info-pickup-availability-'
          | append: section.id
        -%}
        {%- render 'product-pickup-availability',
          product: product,
          section: section,
          block: block,
          data_id: pickup_availability_id,
          class: 'col-span-full'
        -%}
      {%- when 'complementary' -%}
        {%- assign complementary_id = 'product-info-complementary-'
          | append: section.id
        -%}
        {%- render 'product-complementary',
          product: product,
          section: section,
          block: block,
          data_id: complementary_id,
          class: 'col-span-full'
        -%}
    {%- endcase -%}
  {%- endfor -%}

  <!-- Loading overlay -->
  {%- assign loader_id = 'product-info-loader-' | append: section.id -%}
  {%- render 'loading-overlay',
    data_id: loader_id,
    class: 'group-data-[loading]/info:opacity-100 opacity-0 group-data-[loading]/info:visible invisible'
  -%}

  <!-- Error message -->
  {%- assign error_id = 'product-info-error-' | append: section.id -%}
  {%- render 'error-message',
    data_id: error_id,
    class: 'group-data-[error]/info:opacity-100 opacity-0 group-data-[error]/info:block hidden group-data-[error]/info:visible invisible'
  -%}
</cmp-product-info>
